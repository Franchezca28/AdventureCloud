

name: CI

on:
  push:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: 游빌 Checkout del repositorio
        uses: actions/checkout@v4

      - name: 游릭 Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: 游닍 Instalar dependencias
        run: |
          if [ -f package.json ]; then
            npm install
          elif [ -f app/package.json ]; then
            cd app && npm install
          else
            echo "丘멆잺 No se encontr칩 package.json" && exit 1
          fi

      - name: 游빍 Ejecutar pruebas b치sicas
        run: |
          if [ -f package.json ]; then
            npm test || echo "Tests ejecutados"
          elif [ -f app/package.json ]; then
            cd app && npm test || echo "Tests ejecutados"
          fi

      - name: 游냡 Construir imagen Docker
        run: |
          if [ -f Dockerfile ]; then
            docker build -t adventurecloud:${{ github.sha }} .
          elif [ -f app/Dockerfile ]; then
            cd app && docker build -t adventurecloud:${{ github.sha }} .
          else
            echo "丘멆잺 No se encontr칩 Dockerfile" && exit 1
          fi
